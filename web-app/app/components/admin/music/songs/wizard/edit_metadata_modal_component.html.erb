<div id="<%= modal_id %>">
  <dialog id="<%= dialog_id %>" class="modal">
    <div class="modal-box max-w-2xl">
      <h3 class="font-bold text-lg">Edit Metadata</h3>
      <p class="text-sm text-base-content/70 mt-1"><%= item_label %></p>

      <%= form_with url: form_url,
                    method: :patch,
                    data: {
                      controller: "metadata-editor modal-form",
                      modal_form_modal_id_value: dialog_id,
                      turbo_frame: "_top"
                    } do |f| %>

        <div class="form-control mt-4">
          <label for="list_item_metadata_json" class="label">
            <span class="label-text">Metadata (JSON):</span>
          </label>
          <textarea name="list_item[metadata_json]"
                    id="list_item_metadata_json"
                    rows="15"
                    class="textarea textarea-bordered font-mono text-sm w-full"
                    data-metadata-editor-target="textarea"
                    data-action="input->metadata-editor#validate"><%= formatted_metadata %></textarea>
          <div id="<%= error_id %>" class="text-error text-sm mt-2" data-metadata-editor-target="error"></div>
        </div>

        <div class="modal-action">
          <button type="button" class="btn" onclick="<%= dialog_id %>.close()">Cancel</button>
          <%= f.submit "Save", class: "btn btn-primary", data: { metadata_editor_target: "submitButton" } %>
        </div>
      <% end %>
    </div>
    <form method="dialog" class="modal-backdrop">
      <button>close</button>
    </form>
  </dialog>
</div>
