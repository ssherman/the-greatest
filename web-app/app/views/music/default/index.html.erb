<%
  content_for :page_title, "Greatest Songs & Albums Ranked | The Greatest Music"
  content_for :meta_description, "Discover definitive rankings of the greatest songs and albums of all time. Expert reviews, curated lists, and comprehensive music analysis."
%>

<div class="hero min-h-[60vh] bg-gradient-to-r from-purple-600 to-blue-600">
  <div class="hero-content text-center text-white">
    <div class="max-w-2xl">
      <h1 class="mb-6 text-6xl font-bold">The Greatest Music</h1>
      <p class="mb-8 text-xl">
        Discover definitive rankings of the greatest songs and albums of all time.
      </p>
      <div class="flex gap-4 justify-center">
        <%= link_to "Top Albums", albums_path, class: "btn btn-primary btn-lg" %>
        <%= link_to "Top Songs", songs_path, class: "btn btn-outline btn-lg text-white border-white hover:bg-white hover:text-purple-600" %>
      </div>
    </div>
  </div>
</div>

<div class="container mx-auto px-4 py-12">
  <% if @featured_albums&.any? %>
    <div class="mb-12">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-3xl font-bold">Top Ranked Albums</h2>
        <%= link_to "View All â†’", albums_path, class: "btn btn-ghost" %>
      </div>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
        <% @featured_albums.each do |ranked_item| %>
          <% album = ranked_item.item %>
          <%= link_to_album album, @primary_album_rc, class: "card bg-base-100 shadow-lg hover:shadow-xl transition-shadow" do %>
            <figure class="px-2 pt-2">
              <% if album.primary_image&.file&.attached? %>
                <%= image_tag rails_public_blob_url(album.primary_image.file),
                    alt: album.title,
                    class: "rounded-lg w-full aspect-square object-cover" %>
              <% else %>
                <div class="bg-base-200 rounded-lg w-full aspect-square flex items-center justify-center">
                  <span class="text-4xl">ðŸŽµ</span>
                </div>
              <% end %>
            </figure>
            <div class="card-body p-3">
              <div class="badge badge-primary badge-sm font-bold mb-1">
                #<%= ranked_item.rank %>
              </div>
              <h3 class="font-semibold text-sm line-clamp-2 leading-tight">
                <%= album.title %>
              </h3>
              <p class="text-xs text-base-content/70 line-clamp-1">
                <%= album.artists.map(&:name).join(", ") %>
              </p>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>

  <% if @featured_songs&.any? %>
    <div>
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-3xl font-bold">Top Ranked Songs</h2>
        <%= link_to "View All â†’", songs_path, class: "btn btn-ghost" %>
      </div>
      <div class="card bg-base-100 shadow-lg">
        <div class="card-body p-0">
          <div class="overflow-x-auto">
            <table class="table">
              <thead>
                <tr>
                  <th class="w-16 text-center">Rank</th>
                  <th>Title</th>
                  <th class="hidden md:table-cell">Artist(s)</th>
                </tr>
              </thead>
              <tbody>
                <% @featured_songs.each do |ranked_item| %>
                  <% song = ranked_item.item %>
                  <tr class="hover">
                    <td class="text-center">
                      <div class="badge badge-primary font-bold">
                        #<%= ranked_item.rank %>
                      </div>
                    </td>
                    <td>
                      <%= link_to_song song, @primary_song_rc, class: "font-bold hover:text-primary" %>
                      <div class="text-sm text-base-content/70">
                        by
                        <% song.artists.each_with_index do |artist, index| %>
                          <%= link_to_artist artist, class: "hover:text-primary" %><%= index < song.artists.count - 1 ? ", " : "" %>
                        <% end %>
                      </div>
                    </td>
                    <td class="hidden md:table-cell text-base-content/80">
                      <% song.artists.each_with_index do |artist, index| %>
                        <%= link_to_artist artist, class: "hover:text-primary" %><%= index < song.artists.count - 1 ? ", " : "" %>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
